[
{"event_id": "40961", "version": "1", "level": "4", "task": "4", "opcode": "1", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:12:55.853058+00:00", "record_id": "1", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {}},
{"event_id": "53504", "version": "1", "level": "4", "task": "111", "opcode": "10", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:12:56.621634+00:00", "record_id": "2", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {"param1": "10356", "param2": "DefaultAppDomain"}},
{"event_id": "40962", "version": "1", "level": "4", "task": "4", "opcode": "2", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:12:57.091448+00:00", "record_id": "3", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {}},
{"event_id": "4104", "version": "1", "level": "3", "task": "2", "opcode": "15", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:12:57.611074+00:00", "record_id": "4", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {"MessageNumber": "1", "MessageTotal": "1", "ScriptBlockText": "\n $type = @\"\n using System;\n using System.IO;\n using System.Runtime.InteropServices;\n public class Util\n {\n [StructLayout(LayoutKind.Sequential, Pack=8)]\n public struct UNICODE_STRING : IDisposable\n {\n public ushort Length;\n public ushort MaximumLength;\n private IntPtr buffer;\n public UNICODE_STRING(string s)\n {\n Length = (ushort)(s.Length * 2);\n MaximumLength = (ushort)(Length + 2);\n buffer = Marshal.StringToHGlobalUni(s);\n }\n public void Dispose()\n {\n Marshal.FreeHGlobal(buffer);\n buffer = IntPtr.Zero;\n }\n public override string ToString()\n {\n return Marshal.PtrToStringUni(buffer);\n }\n }\n const UInt16 IMAGE_FILE_MACHINE_UNKNOWN = 0x0;\n static IntPtr INVALID_HANDLE_VALUE = (IntPtr)(-1);\n [DllImport(\"kernel32.dll\", EntryPoint=\"BasepGetExeArchType\", CharSet=CharSet.Unicode)]\n public static extern long BasepGetExeArchType(out ushort pExeType, IntPtr hFile, ref UNICODE_STRING FileName);\n [DllImport(\"kernel32.dll\", EntryPoint=\"CreateFileW\", CharSet = CharSet.Unicode)]\n public static extern IntPtr CreateFileW([MarshalAs(UnmanagedType.LPWStr)] string lpFileName,\n [MarshalAs(UnmanagedType.U4)] FileAccess dwDesiredAccess,\n [MarshalAs(UnmanagedType.U4)] FileShare dwShareMode,\n IntPtr lpSecurityAttributes,\n [MarshalAs(UnmanagedType.U4)] FileMode dwCreationDisposition,\n [MarshalAs(UnmanagedType.U4)] FileAttributes dwFlagsAndAttributes,\n IntPtr hTemplateFile);\n [DllImport(\"kernel32.dll\", EntryPoint=\"CloseHandle\", CharSet = CharSet.Unicode)]\n public static extern bool CloseHandle(IntPtr Handle);\n public static ushort GetAppExeType(String AppPath)\n {\n IntPtr FileHandle;\n ushort ExeType = IMAGE_FILE_MACHINE_UNKNOWN;\n FileHandle = CreateFileW(AppPath,\n FileAccess.Read,\n FileShare.Read | FileShare.Delete,\n IntPtr.Zero,\n FileMode.Open,\n FileAttributes.Normal,\n IntPtr.Zero);\n if (INVALID_HANDLE_VALUE != FileHandle)\n {\n UNICODE_STRING FileName = new UNICODE_STRING(AppPath);\n ushort TempExeType = IMAGE_FILE_MACHINE_UNKNOWN;\n long Status;\n Status = BasepGetExeArchType(out TempExeType, FileHandle, ref FileName);\n if (Status >= 0)\n {\n ExeType = TempExeType;\n }\n CloseHandle(FileHandle);\n }\n return ExeType;\n }\n }\n\"@\n Add-Type -TypeDefinition $type -PassThru -IgnoreWarnings | out-null; $res = 0; if(\n ((test-path $env:windir\\system32\\concrt140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\concrt140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140chs.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140chs.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140cht.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140cht.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140deu.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140deu.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140enu.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140enu.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140esn.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140esn.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140fra.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140fra.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140ita.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140ita.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140jpn.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140jpn.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140kor.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140kor.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140rus.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140rus.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140u.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140u.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_1.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_1.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_2.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_2.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_atomic_wait.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_atomic_wait.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_codecvt_ids.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_codecvt_ids.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vcamp140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vcamp140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vccorlib140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vccorlib140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vcomp140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vcomp140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vcruntime140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vcruntime140.dll\") -eq 0x8664)\n ){$res=1}; Write-Host \"Final result:\", $res\n", "ScriptBlockId": "c44459e6-2524-4b5f-9862-d895fd10c318", "Path": null}},
{"event_id": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:12:59.292450+00:00", "record_id": "5", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {"ContextInfo": "        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.26100.7019\n        Host ID = 522dfbf9-b4ae-4c8d-b82e-d379b36afefd\n        Host Application = powershell.exe -ExecutionPolicy Restricted -Command \n $type = @\"\n                using System;\n                using System.IO;\n                using System.Runtime.InteropServices;\n                public class Util\n                {\n                    [StructLayout(LayoutKind.Sequential, Pack=8)]\n                    public struct UNICODE_STRING : IDisposable\n                    {\n                        public ushort Length;\n                        public ushort MaximumLength;\n                        private IntPtr buffer;\n                        public UNICODE_STRING(string s)\n                        {\n                            Length = (ushort)(s.Length * 2);\n                            MaximumLength = (ushort)(Length + 2);\n                            buffer = Marshal.StringToHGlobalUni(s);\n                        }\n                        public void Dispose()\n                        {\n                            Marshal.FreeHGlobal(buffer);\n                            buffer = IntPtr.Zero;\n                        }\n                        public override string ToString()\n                        {\n                            return Marshal.PtrToStringUni(buffer);\n                        }\n                    }\n                    const UInt16 IMAGE_FILE_MACHINE_UNKNOWN = 0x0;\n                    static IntPtr INVALID_HANDLE_VALUE    = (IntPtr)(-1);\n                    [DllImport(\"kernel32.dll\", EntryPoint=\"BasepGetExeArchType\", CharSet=CharSet.Unicode)]\n                    public static extern long BasepGetExeArchType(out ushort pExeType, IntPtr hFile, ref UNICODE_STRING FileName);\n                    [DllImport(\"kernel32.dll\", EntryPoint=\"CreateFileW\", CharSet = CharSet.Unicode)]\n                    public static extern IntPtr CreateFileW([MarshalAs(UnmanagedType.LPWStr)] string lpFileName,\n                                                            [MarshalAs(UnmanagedType.U4)] FileAccess dwDesiredAccess,\n                                                            [MarshalAs(UnmanagedType.U4)] FileShare dwShareMode,\n                                                            IntPtr lpSecurityAttributes,\n                                                            [MarshalAs(UnmanagedType.U4)] FileMode dwCreationDisposition,\n                                                            [MarshalAs(UnmanagedType.U4)] FileAttributes dwFlagsAndAttributes,\n                                                            IntPtr hTemplateFile);\n                    [DllImport(\"kernel32.dll\", EntryPoint=\"CloseHandle\", CharSet = CharSet.Unicode)]\n                    public static extern bool CloseHandle(IntPtr Handle);\n                    public static ushort GetAppExeType(String AppPath)\n                    {\n                        IntPtr FileHandle;\n                        ushort ExeType = IMAGE_FILE_MACHINE_UNKNOWN;\n                        FileHandle = CreateFileW(AppPath,\n                                                 FileAccess.Read,\n                                                 FileShare.Read | FileShare.Delete,\n                                                 IntPtr.Zero,\n                                                 FileMode.Open,\n                                                 FileAttributes.Normal,\n                                                 IntPtr.Zero);\n                        if (INVALID_HANDLE_VALUE != FileHandle)\n                        {\n                            UNICODE_STRING FileName = new UNICODE_STRING(AppPath);\n                            ushort TempExeType = IMAGE_FILE_MACHINE_UNKNOWN;\n                            long Status;\n                            Status = BasepGetExeArchType(out TempExeType, FileHandle, ref FileName);\n                            if (Status >= 0)\n                            {\n                                ExeType = TempExeType;\n                            }\n                            CloseHandle(FileHandle);\n                        }\n                        return ExeType;\n                    }\n                }\n\"@\n Add-Type -TypeDefinition $type -PassThru -IgnoreWarnings | out-null; $res = 0; if(\n ((test-path $env:windir\\system32\\concrt140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\concrt140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140chs.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140chs.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140cht.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140cht.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140deu.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140deu.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140enu.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140enu.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140esn.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140esn.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140fra.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140fra.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140ita.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140ita.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140jpn.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140jpn.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140kor.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140kor.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140rus.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140rus.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140u.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140u.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_1.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_1.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_2.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_2.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_atomic_wait.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_atomic_wait.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_codecvt_ids.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_codecvt_ids.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vcamp140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vcamp140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vccorlib140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vccorlib140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vcomp140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vcomp140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vcruntime140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vcruntime140.dll\") -eq 0x8664)\n ){$res=1}; Write-Host \"Final result:\", $res\n\n        Engine Version = 5.1.26100.7019\n        Runspace ID = 8bbe8a4b-563c-4084-849c-105ab928cd83\n        Pipeline ID = 1\n        Command Name = Add-Type\n        Command Type = Cmdlet\n        Script Name = \n        Command Path = \n        Sequence Number = 28\n        User = WORKGROUP\\SYSTEM\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n", "UserData": null, "Payload": "CommandInvocation(Add-Type): \"Add-Type\"\nParameterBinding(Add-Type): name=\"TypeDefinition\"; value=\" using System;\n using System.IO;\n using System.Runtime.InteropServices;\n public class Util\n {\n [StructLayout(LayoutKind.Sequential, Pack=8)]\n public struct UNICODE_STRING : IDisposable\n {\n public ushort Length;\n public ushort MaximumLength;\n private IntPtr buffer;\n public UNICODE_STRING(string s)\n {\n Length = (ushort)(s.Length * 2);\n MaximumLength = (ushort)(Length + 2);\n buffer = Marshal.StringToHGlobalUni(s);\n }\n public void Dispose()\n {\n Marshal.FreeHGlobal(buffer);\n buffer = IntPtr.Zero;\n }\n public override string ToString()\n {\n return Marshal.PtrToStringUni(buffer);\n }\n }\n const UInt16 IMAGE_FILE_MACHINE_UNKNOWN = 0x0;\n static IntPtr INVALID_HANDLE_VALUE = (IntPtr)(-1);\n [DllImport(\"kernel32.dll\", EntryPoint=\"BasepGetExeArchType\", CharSet=CharSet.Unicode)]\n public static extern long BasepGetExeArchType(out ushort pExeType, IntPtr hFile, ref UNICODE_STRING FileName);\n [DllImport(\"kernel32.dll\", EntryPoint=\"CreateFileW\", CharSet = CharSet.Unicode)]\n public static extern IntPtr CreateFileW([MarshalAs(UnmanagedType.LPWStr)] string lpFileName,\n [MarshalAs(UnmanagedType.U4)] FileAccess dwDesiredAccess,\n [MarshalAs(UnmanagedType.U4)] FileShare dwShareMode,\n IntPtr lpSecurityAttributes,\n [MarshalAs(UnmanagedType.U4)] FileMode dwCreationDisposition,\n [MarshalAs(UnmanagedType.U4)] FileAttributes dwFlagsAndAttributes,\n IntPtr hTemplateFile);\n [DllImport(\"kernel32.dll\", EntryPoint=\"CloseHandle\", CharSet = CharSet.Unicode)]\n public static extern bool CloseHandle(IntPtr Handle);\n public static ushort GetAppExeType(String AppPath)\n {\n IntPtr FileHandle;\n ushort ExeType = IMAGE_FILE_MACHINE_UNKNOWN;\n FileHandle = CreateFileW(AppPath,\n FileAccess.Read,\n FileShare.Read | FileShare.Delete,\n IntPtr.Zero,\n FileMode.Open,\n FileAttributes.Normal,\n IntPtr.Zero);\n if (INVALID_HANDLE_VALUE != FileHandle)\n {\n UNICODE_STRING FileName = new UNICODE_STRING(AppPath);\n ushort TempExeType = IMAGE_FILE_MACHINE_UNKNOWN;\n long Status;\n Status = BasepGetExeArchType(out TempExeType, FileHandle, ref FileName);\n if (Status >= 0)\n {\n ExeType = TempExeType;\n }\n CloseHandle(FileHandle);\n }\n return ExeType;\n }\n }\"\nParameterBinding(Add-Type): name=\"PassThru\"; value=\"True\"\nParameterBinding(Add-Type): name=\"IgnoreWarnings\"; value=\"True\"\nCommandInvocation(Out-Null): \"Out-Null\"\n"}},
{"event_id": "40961", "version": "1", "level": "4", "task": "4", "opcode": "1", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:13:01.780556+00:00", "record_id": "6", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {}},
{"event_id": "53504", "version": "1", "level": "4", "task": "111", "opcode": "10", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:13:02.713945+00:00", "record_id": "7", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {"param1": "1132", "param2": "DefaultAppDomain"}},
{"event_id": "40962", "version": "1", "level": "4", "task": "4", "opcode": "2", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:13:03.218479+00:00", "record_id": "8", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {}},
{"event_id": "40961", "version": "1", "level": "4", "task": "4", "opcode": "1", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:13:05.206684+00:00", "record_id": "9", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {}},
{"event_id": "53504", "version": "1", "level": "4", "task": "111", "opcode": "10", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:13:05.883013+00:00", "record_id": "10", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {"param1": "1888", "param2": "DefaultAppDomain"}},
{"event_id": "40962", "version": "1", "level": "4", "task": "4", "opcode": "2", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:13:06.622887+00:00", "record_id": "11", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {}},
{"event_id": "4104", "version": "1", "level": "3", "task": "2", "opcode": "15", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:13:07.224926+00:00", "record_id": "12", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {"MessageNumber": "1", "MessageTotal": "1", "ScriptBlockText": "\n $type = @\"\n using System;\n using System.IO;\n using System.Runtime.InteropServices;\n public class Util\n {\n [StructLayout(LayoutKind.Sequential, Pack=8)]\n public struct UNICODE_STRING : IDisposable\n {\n public ushort Length;\n public ushort MaximumLength;\n private IntPtr buffer;\n public UNICODE_STRING(string s)\n {\n Length = (ushort)(s.Length * 2);\n MaximumLength = (ushort)(Length + 2);\n buffer = Marshal.StringToHGlobalUni(s);\n }\n public void Dispose()\n {\n Marshal.FreeHGlobal(buffer);\n buffer = IntPtr.Zero;\n }\n public override string ToString()\n {\n return Marshal.PtrToStringUni(buffer);\n }\n }\n const UInt16 IMAGE_FILE_MACHINE_UNKNOWN = 0x0;\n static IntPtr INVALID_HANDLE_VALUE = (IntPtr)(-1);\n [DllImport(\"kernel32.dll\", EntryPoint=\"BasepGetExeArchType\", CharSet=CharSet.Unicode)]\n public static extern long BasepGetExeArchType(out ushort pExeType, IntPtr hFile, ref UNICODE_STRING FileName);\n [DllImport(\"kernel32.dll\", EntryPoint=\"CreateFileW\", CharSet = CharSet.Unicode)]\n public static extern IntPtr CreateFileW([MarshalAs(UnmanagedType.LPWStr)] string lpFileName,\n [MarshalAs(UnmanagedType.U4)] FileAccess dwDesiredAccess,\n [MarshalAs(UnmanagedType.U4)] FileShare dwShareMode,\n IntPtr lpSecurityAttributes,\n [MarshalAs(UnmanagedType.U4)] FileMode dwCreationDisposition,\n [MarshalAs(UnmanagedType.U4)] FileAttributes dwFlagsAndAttributes,\n IntPtr hTemplateFile);\n [DllImport(\"kernel32.dll\", EntryPoint=\"CloseHandle\", CharSet = CharSet.Unicode)]\n public static extern bool CloseHandle(IntPtr Handle);\n public static ushort GetAppExeType(String AppPath)\n {\n IntPtr FileHandle;\n ushort ExeType = IMAGE_FILE_MACHINE_UNKNOWN;\n FileHandle = CreateFileW(AppPath,\n FileAccess.Read,\n FileShare.Read | FileShare.Delete,\n IntPtr.Zero,\n FileMode.Open,\n FileAttributes.Normal,\n IntPtr.Zero);\n if (INVALID_HANDLE_VALUE != FileHandle)\n {\n UNICODE_STRING FileName = new UNICODE_STRING(AppPath);\n ushort TempExeType = IMAGE_FILE_MACHINE_UNKNOWN;\n long Status;\n Status = BasepGetExeArchType(out TempExeType, FileHandle, ref FileName);\n if (Status >= 0)\n {\n ExeType = TempExeType;\n }\n CloseHandle(FileHandle);\n }\n return ExeType;\n }\n }\n\"@\n Add-Type -TypeDefinition $type -PassThru -IgnoreWarnings | out-null; $res = 0; if(\n ((test-path $env:windir\\system32\\concrt140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\concrt140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140chs.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140chs.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140cht.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140cht.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140deu.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140deu.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140enu.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140enu.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140esn.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140esn.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140fra.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140fra.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140ita.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140ita.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140jpn.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140jpn.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140kor.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140kor.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140rus.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140rus.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140u.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140u.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_1.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_1.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_2.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_2.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_atomic_wait.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_atomic_wait.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_codecvt_ids.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_codecvt_ids.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vcamp140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vcamp140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vccorlib140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vccorlib140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vcomp140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vcomp140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vcruntime140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vcruntime140.dll\") -eq 0x8664)\n ){$res=1}; Write-Host \"Final result:\", $res\n", "ScriptBlockId": "3366b8a2-e414-4978-9d73-620f8e5073bb", "Path": null}},
{"event_id": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:13:08.366518+00:00", "record_id": "13", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {"ContextInfo": "        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.26100.7019\n        Host ID = d7cba5f3-c632-4ef6-8dfd-cd6cad01532d\n        Host Application = powershell.exe -ExecutionPolicy Restricted -Command \n $type = @\"\n                using System;\n                using System.IO;\n                using System.Runtime.InteropServices;\n                public class Util\n                {\n                    [StructLayout(LayoutKind.Sequential, Pack=8)]\n                    public struct UNICODE_STRING : IDisposable\n                    {\n                        public ushort Length;\n                        public ushort MaximumLength;\n                        private IntPtr buffer;\n                        public UNICODE_STRING(string s)\n                        {\n                            Length = (ushort)(s.Length * 2);\n                            MaximumLength = (ushort)(Length + 2);\n                            buffer = Marshal.StringToHGlobalUni(s);\n                        }\n                        public void Dispose()\n                        {\n                            Marshal.FreeHGlobal(buffer);\n                            buffer = IntPtr.Zero;\n                        }\n                        public override string ToString()\n                        {\n                            return Marshal.PtrToStringUni(buffer);\n                        }\n                    }\n                    const UInt16 IMAGE_FILE_MACHINE_UNKNOWN = 0x0;\n                    static IntPtr INVALID_HANDLE_VALUE    = (IntPtr)(-1);\n                    [DllImport(\"kernel32.dll\", EntryPoint=\"BasepGetExeArchType\", CharSet=CharSet.Unicode)]\n                    public static extern long BasepGetExeArchType(out ushort pExeType, IntPtr hFile, ref UNICODE_STRING FileName);\n                    [DllImport(\"kernel32.dll\", EntryPoint=\"CreateFileW\", CharSet = CharSet.Unicode)]\n                    public static extern IntPtr CreateFileW([MarshalAs(UnmanagedType.LPWStr)] string lpFileName,\n                                                            [MarshalAs(UnmanagedType.U4)] FileAccess dwDesiredAccess,\n                                                            [MarshalAs(UnmanagedType.U4)] FileShare dwShareMode,\n                                                            IntPtr lpSecurityAttributes,\n                                                            [MarshalAs(UnmanagedType.U4)] FileMode dwCreationDisposition,\n                                                            [MarshalAs(UnmanagedType.U4)] FileAttributes dwFlagsAndAttributes,\n                                                            IntPtr hTemplateFile);\n                    [DllImport(\"kernel32.dll\", EntryPoint=\"CloseHandle\", CharSet = CharSet.Unicode)]\n                    public static extern bool CloseHandle(IntPtr Handle);\n                    public static ushort GetAppExeType(String AppPath)\n                    {\n                        IntPtr FileHandle;\n                        ushort ExeType = IMAGE_FILE_MACHINE_UNKNOWN;\n                        FileHandle = CreateFileW(AppPath,\n                                                 FileAccess.Read,\n                                                 FileShare.Read | FileShare.Delete,\n                                                 IntPtr.Zero,\n                                                 FileMode.Open,\n                                                 FileAttributes.Normal,\n                                                 IntPtr.Zero);\n                        if (INVALID_HANDLE_VALUE != FileHandle)\n                        {\n                            UNICODE_STRING FileName = new UNICODE_STRING(AppPath);\n                            ushort TempExeType = IMAGE_FILE_MACHINE_UNKNOWN;\n                            long Status;\n                            Status = BasepGetExeArchType(out TempExeType, FileHandle, ref FileName);\n                            if (Status >= 0)\n                            {\n                                ExeType = TempExeType;\n                            }\n                            CloseHandle(FileHandle);\n                        }\n                        return ExeType;\n                    }\n                }\n\"@\n Add-Type -TypeDefinition $type -PassThru -IgnoreWarnings | out-null; $res = 0; if(\n ((test-path $env:windir\\system32\\concrt140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\concrt140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140chs.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140chs.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140cht.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140cht.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140deu.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140deu.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140enu.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140enu.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140esn.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140esn.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140fra.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140fra.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140ita.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140ita.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140jpn.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140jpn.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140kor.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140kor.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140rus.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140rus.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\mfc140u.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\mfc140u.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_1.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_1.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_2.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_2.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_atomic_wait.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_atomic_wait.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\msvcp140_codecvt_ids.dll) -and [Util]::GetAppExeType(\"$env:windir\\system32\\msvcp140_codecvt_ids.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vcamp140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vcamp140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vccorlib140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vccorlib140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vcomp140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vcomp140.dll\") -eq 0x8664) -or\n ((test-path $env:windir\\system32\\vcruntime140.dll ) -and [Util]::GetAppExeType(\"$env:windir\\system32\\vcruntime140.dll\") -eq 0x8664)\n ){$res=1}; Write-Host \"Final result:\", $res\n\n        Engine Version = 5.1.26100.7019\n        Runspace ID = 48cbea3e-6b08-4153-921c-c69c86663ebd\n        Pipeline ID = 1\n        Command Name = Add-Type\n        Command Type = Cmdlet\n        Script Name = \n        Command Path = \n        Sequence Number = 28\n        User = WORKGROUP\\SYSTEM\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n", "UserData": null, "Payload": "CommandInvocation(Add-Type): \"Add-Type\"\nParameterBinding(Add-Type): name=\"TypeDefinition\"; value=\" using System;\n using System.IO;\n using System.Runtime.InteropServices;\n public class Util\n {\n [StructLayout(LayoutKind.Sequential, Pack=8)]\n public struct UNICODE_STRING : IDisposable\n {\n public ushort Length;\n public ushort MaximumLength;\n private IntPtr buffer;\n public UNICODE_STRING(string s)\n {\n Length = (ushort)(s.Length * 2);\n MaximumLength = (ushort)(Length + 2);\n buffer = Marshal.StringToHGlobalUni(s);\n }\n public void Dispose()\n {\n Marshal.FreeHGlobal(buffer);\n buffer = IntPtr.Zero;\n }\n public override string ToString()\n {\n return Marshal.PtrToStringUni(buffer);\n }\n }\n const UInt16 IMAGE_FILE_MACHINE_UNKNOWN = 0x0;\n static IntPtr INVALID_HANDLE_VALUE = (IntPtr)(-1);\n [DllImport(\"kernel32.dll\", EntryPoint=\"BasepGetExeArchType\", CharSet=CharSet.Unicode)]\n public static extern long BasepGetExeArchType(out ushort pExeType, IntPtr hFile, ref UNICODE_STRING FileName);\n [DllImport(\"kernel32.dll\", EntryPoint=\"CreateFileW\", CharSet = CharSet.Unicode)]\n public static extern IntPtr CreateFileW([MarshalAs(UnmanagedType.LPWStr)] string lpFileName,\n [MarshalAs(UnmanagedType.U4)] FileAccess dwDesiredAccess,\n [MarshalAs(UnmanagedType.U4)] FileShare dwShareMode,\n IntPtr lpSecurityAttributes,\n [MarshalAs(UnmanagedType.U4)] FileMode dwCreationDisposition,\n [MarshalAs(UnmanagedType.U4)] FileAttributes dwFlagsAndAttributes,\n IntPtr hTemplateFile);\n [DllImport(\"kernel32.dll\", EntryPoint=\"CloseHandle\", CharSet = CharSet.Unicode)]\n public static extern bool CloseHandle(IntPtr Handle);\n public static ushort GetAppExeType(String AppPath)\n {\n IntPtr FileHandle;\n ushort ExeType = IMAGE_FILE_MACHINE_UNKNOWN;\n FileHandle = CreateFileW(AppPath,\n FileAccess.Read,\n FileShare.Read | FileShare.Delete,\n IntPtr.Zero,\n FileMode.Open,\n FileAttributes.Normal,\n IntPtr.Zero);\n if (INVALID_HANDLE_VALUE != FileHandle)\n {\n UNICODE_STRING FileName = new UNICODE_STRING(AppPath);\n ushort TempExeType = IMAGE_FILE_MACHINE_UNKNOWN;\n long Status;\n Status = BasepGetExeArchType(out TempExeType, FileHandle, ref FileName);\n if (Status >= 0)\n {\n ExeType = TempExeType;\n }\n CloseHandle(FileHandle);\n }\n return ExeType;\n }\n }\"\nParameterBinding(Add-Type): name=\"PassThru\"; value=\"True\"\nParameterBinding(Add-Type): name=\"IgnoreWarnings\"; value=\"True\"\nCommandInvocation(Out-Null): \"Out-Null\"\n"}},
{"event_id": "40961", "version": "1", "level": "4", "task": "4", "opcode": "1", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:13:09.055117+00:00", "record_id": "14", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {}},
{"event_id": "53504", "version": "1", "level": "4", "task": "111", "opcode": "10", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:13:09.476910+00:00", "record_id": "15", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {"param1": "5556", "param2": "DefaultAppDomain"}},
{"event_id": "40962", "version": "1", "level": "4", "task": "4", "opcode": "2", "keywords": "0x0000000000000000", "timestamp": "2025-11-23 07:13:09.827915+00:00", "record_id": "16", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-18", "event_data": {}},
{"event_id": "40961", "version": "1", "level": "4", "task": "4", "opcode": "1", "keywords": "0x0000000000000000", "timestamp": "2025-12-04 08:48:49.328829+00:00", "record_id": "17", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-21-3406557415-3785955325-3440082762-1001", "event_data": {}},
{"event_id": "53504", "version": "1", "level": "4", "task": "111", "opcode": "10", "keywords": "0x0000000000000000", "timestamp": "2025-12-04 08:48:49.647449+00:00", "record_id": "18", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-21-3406557415-3785955325-3440082762-1001", "event_data": {"param1": "4544", "param2": "DefaultAppDomain"}},
{"event_id": "40962", "version": "1", "level": "4", "task": "4", "opcode": "2", "keywords": "0x0000000000000000", "timestamp": "2025-12-04 08:48:50.736387+00:00", "record_id": "19", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-21-3406557415-3785955325-3440082762-1001", "event_data": {}},
{"event_id": "40961", "version": "1", "level": "4", "task": "4", "opcode": "1", "keywords": "0x0000000000000000", "timestamp": "2025-12-04 08:55:12.373743+00:00", "record_id": "20", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-21-3406557415-3785955325-3440082762-1001", "event_data": {}},
{"event_id": "53504", "version": "1", "level": "4", "task": "111", "opcode": "10", "keywords": "0x0000000000000000", "timestamp": "2025-12-04 08:55:12.555824+00:00", "record_id": "21", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-21-3406557415-3785955325-3440082762-1001", "event_data": {"param1": "10624", "param2": "DefaultAppDomain"}},
{"event_id": "40962", "version": "1", "level": "4", "task": "4", "opcode": "2", "keywords": "0x0000000000000000", "timestamp": "2025-12-04 08:55:13.093130+00:00", "record_id": "22", "computer": "WIN-QCM4OJM0UCK", "channel": "Microsoft-Windows-PowerShell/Operational", "security_user": "S-1-5-21-3406557415-3785955325-3440082762-1001", "event_data": {}}
]
